<html>
<head>
	<title>Tasks</title>
	<link rel="stylesheet" href="Tasks.css" type="text/css">
</head>
<body>
<script type="text/javascript" src="lib/fin/lib/js.io/packages/jsio.js"></script>
<script>
	jsio.path.browser = 'lib/fin/js'
	jsio.path.common = 'lib/fin/js'
	jsio.path.ui = 'js/'
	jsio.path.tasks = 'js/'

	jsio('import browser.fin as fin')

	jsio('import tasks.LoginManager')
	jsio('import tasks.panels.LabelsPanel')
	jsio('import tasks.panels.ListPanel')
	jsio('import tasks.panels.ItemPanel')

	var gBody = document.body
	var gIsConnected = false
	var gUser = 'marcus@meebo-inc.com'

	var gLoginManager = new tasks.LoginManager()
	// gLoginManager.appendTo(gBody)
	// gLoginManager.subscribe('Submit', function(email, password){
	// 	gUser = email
	// 	testLoggedIn()
	// })
	
	var gLabelsPanel = new tasks.panels.LabelsPanel()
	var gListPanel = new tasks.panels.ListPanel()
	var gItemPanel = new tasks.panels.ItemPanel()

	fin.connect(function(){
		gIsConnected = true
		testLoggedIn()
	})
	
	function testLoggedIn() {
		if (!gIsConnected || !gUser) { return } // wait for both login and succesfull connection
		gLoginManager.remove()
		gLabelsPanel.appendTo(gBody)
		gListPanel.appendTo(gBody)
		gItemPanel.appendTo(gBody)
	}
</script>

<body>
<script type="text/javascript">

	Meebo=function(){(Meebo._=Meebo._||[]).push(arguments)};
	(function(q){
		return // Let's not add the bar on there just yet
		
		var args = arguments;
		if (!document.body){return setTimeout(function(){args.callee.apply(this,args)},100);}
		var d=document,b=d.body,m=b.insertBefore(d.createElement('div'),b.firstChild),s=d.createElement('script');
		m.id='meebo';m.style.display='none';m.innerHTML='<iframe id="meebo-iframe"></iframe>';
		s.src='http'+(q.https?'s':'')+'://'+(q.stage?'stage-':'')+'cim.meebo.com/cim/cim.php?network='+q.network;
		b.insertBefore(s,b.firstChild);
	})({network:'everywhere',stage:false});
	Meebo('domReady')
</script>
</body>
</html>
